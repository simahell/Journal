\documentclass[journal]{IEEEtran}
\input{settings}
\begin{document}

\section{はじめに}
\label{sec:introduction}

\subsection{背景}
ウェブは多様な構成要素やプロトコルを持つ非常に複雑なシステムである。
しかし、広く一般的に利用されていることから、漏れのない確かな安全性が求められる。
システムに対しての安全性解析には大きく２つの手法が存在し、１つ目はシステムに適当な入力を与えてシステムの動作をシミュレーションする方法である。
この手法は安全性解析にかかるコストが比較的低く産業界で一般的に利用されるが、仕様外の動作など潜在的な脆弱性が残る可能性が高い。
一方で、システムの仕様等を命題論理で表したセキュリティモデルを作成し、これを用いて数学的に安全性解析を行う手法を形式手法と呼ぶ。
この手法では、セキュリティモデルを作成するというコストがかかるが、セキュリティモデルがシステムを正確に表現できていれば、数学的な解析により漏れの無い安全性解析が可能になる。
このような背景に対しAhkaweら\cite{based-model}は、後発のWeb セキュリティの研究の解析支援を目的として、汎用的なモデルを提案した。
彼らの成果は後述するRickら\cite{cookie-model}の拡張をはじめ、多くの研究で利用されている\cite{chaitanya2017formal, bagheri2016practical, chen2015aspire, nelson2013aluminum, somorovsky2011all}。

一般に、形式手法ではセキュリティモデルがシステムを正確に表現できていることが極めて重要であるが、Ahkaweらによるモデルは包括している内容が不十分である。
これらの既存モデルにはキャッシュが含まれておらず、これらを用いた解析ではキャッシュを利用した攻撃法やそれに関連する危険性を解析できない。

また一方で、既存モデルで実装している時相論理の表現能力も、二つ以上の通信が平行に行われた場合の影響を考慮できておらず、不十分である
そもそも、時相論理は時間変化を表現可能な命題論理であり、セキュリティモデルではシステムの状態変化を表すために用いられる。
この時相論理の表現能力が不足している場合には、システムの状態変化を十分に表現できず、一般的なウェブの解析を行えない。
これは、キャッシュを導入する上でも同様である。
上述したRick らの成果\cite{cookie-model}においてもこの時系列の問題は未解決である。
一方で、かれらの成果を拡張して考えることはその後続研究においても更なる解析支援を促すことにあるため、重要といえる。これにより、本研究ではキャッシュを導入したモデルの構成と、それにあたり、キャッシュのようなウェブの構成要素の状態変化を表現するための時相論理の実装を検討する。

\subsection{貢献}
本研究では、キャッシュを包括するウェブセキュリティモデルを提案する。
また、キャッシュの基本的な動作やBrowser Cache Poisoning Attack\cite{bcpattack}やWeb Cache Deception Attack\cite{WCD}など最新の攻撃を事例として取り上げ、提案モデルの表現能力が既存モデルよりも向上していることを確認する。

本研究における技術的な最大の貢献は、ウェブの構成要素の状態変化を表現できる自走論理の記述法を提案したことである。これは前節で述べた時相論理の問題を解決することで、キャッシュの記述はもちろん、上述したAkhawe らの後続研究含む様々な解析を潜在的に可能にしたことを意味する。

以下に本研究で解決した問題について具体的に述べる。
既存モデルの表現が不十分である理由は、実装に用いられているAlloy Analyzerで用いる言語Alloyが時相論理を表現する記法を持たないためである。
Alloy上で時相論理を表現することは一般に容易ではない。
既存モデル\cite{based-model, cookie-model}においても、この問題点に対し独自の記述法を用いて時相論理を表現しているが、実装できている時相論理の能力に制限が強く、この表現能力はウェブの一般的な解析には適さない。
（詳細は2節で記載する。）
このAlloy 上での時相論理の表現能力を向上させたことが、本研究で解決した課題の直観である。
この詳細は3節に記載する。これにより提案したキャッシュ付きのモデルおよび上述したような最新の攻撃の評価が可能となった。


\subsection{関連研究}
\subsubsection{Web Securityの現状}
また、本研究では主にウェブにおけるHTTPの動作の安全性解析に取り組んでおり、HTTPの運用には様々な脆弱性が存在する。
Jiaら\cite{bcpattack}はブラウザキャッシュを利用したBrowser Cache Poisoning Attackを発見し、これにより攻撃対象のブラウザに任意の挙動をさせることが可能になる。
Ryckら\cite{cookie-model}らはCross-site Request Forgeryという攻撃手法を対象とし、ブラウザでのCookieを用いた対策法の考案を行っている。
Ogawaら\cite{WCD}らは中継者のキャッシュを利用したWeb Cache Deception Attackを発見し、この攻撃により攻撃者は本来アクセス権限を持たないファイルを取得することが可能になる。
これに加えて、HTTPにはその拡張であるHTTPSが存在するが、HTTPSにも脆弱性が報告されている\cite{poodle}。
このような背景から、HTTPSに更なる拡張を行い安全性を向上させた、HTTP Strict Transport Security\cite{hsts}、Public Key Pinning Extension for HTTP\cite{hpkp}が考案され運用が始められている。
しかし、サーバ管理者による設定が不十分であることにより、これらのプロトコルの持つ安全性が維持されていないという現状が報告されている\cite{hstshpkp}。
今後、これらのプロトコルの解析を行い、十分な安全性を保障するための設定基準等を定める必要がある。

\subsubsection{Web Analysis}
本研究では形式手法をウェブというシステムの安全性解析に用いているが、形式手法はシステムのみに限らず、プロトコル単体に対しても利用可能な手法である。
まず、形式手法は様々なネットワークプロトコルの安全性解析に用いられている。
Arnaudら\cite{modeling-and-verifying-ad-hoc}はアドホックネットワークにおけるルーティングプロトコルに対して、その正確性を確認し、また、その計算速度が多項式時間で可能となる条件を発見している。
Brusoら\cite{formal-verification-of-privacy-for}は、ICチップの非接触による近距離無線通信\cite{formal-verification-of-privacy-for}を対象に、二つの安全性要件を定義し一般的に用いられているプロトコルがそれらを満たすために必要な条件を発見した。

\subsubsection{Other Related Works}
またその他の形式手法の利用例として、Nearら\cite{finding_security_bugs_in_web}は特定の要素を含むウェブアプリケーションにおいて、必ず安全性を満たすアクセスパターンを発見している。
Kleinら\cite{sel4_formal_verification_of_an}はseL4というOSのマイクロカーネルに対して、想定されていない動作が存在するか解析し、結果としてそのような動作が起こりえないことを証明した。
Shinら\cite{towards_formal_analysis_of_the}はAndoroid OSの安全性の確認を行っている。
Lieら\cite{specifying_and_verifying_hardware_for_tamper}は耐タンパー性を持つプロセッサが耐タンパー性を失う状態の有無を検査し、その状態に陥る条件を発見している。

このように、現在、形式手法は様々な安全性解析に利用されており、それに向けたセキュリティモデルの構成の整理がなされている\cite{security_modeling_and_analysis}。
セキュリティモデルは大きく三つの要素に分割でき、「検査対象の構造やふるまい」、「脅威モデル」、「安全性要件」で構成される。
これにより、想定した「脅威モデル」によって解析対象が「安全性要件」を満たさない状態が存在するか、また存在する場合にはどのような状態であるのかを考察することが形式手法である。
\end{document}
